<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>커뮤니티게시판</title>
    <link rel="stylesheet" href="/css/community/community.css">
    <link rel="stylesheet" href="/css/fix/header.css">
    <link rel="stylesheet" href="/css/fix/footer.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">
</head>
<style>
    *{
        font-family: "Noto Sans KR" !important;
    }
</style>
<body>
<div th:if="${session.userId}">
    <header th:replace="/app/fix/header.html :: header"/>
</div>
<div th:unless="${session.userId}">
    <header th:replace="/app/fix/headerModify.html:: header"/>
</div>
<input style="display:none;" th:value="${session.userId}" name="userId">
<div class="SocialFeedPage__Wrapper-ky5ymg-0 fzBbGO">
    <div class="SocialFeedPage__Header-ky5ymg-1 jIjcTX">
        <div style="padding-left: 20px; padding-right: 20px;">
            <!--맨 위 제목-->
            <span class="SocialFeedPage__Title-ky5ymg-2 gVPyuz">마음껏 이야기 해보세요 </span>
            <button class="SocialFeedPage__TooltipButton-ky5ymg-3 cUtFFV">
                <img style="padding-bottom: 5px"; src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='17' height='17' viewBox='0 0 17 17'%3E %3Cpath fill='%23CCC' d='M8.5 0C13.194 0 17 3.806 17 8.5S13.194 17 8.5 17 0 13.194 0 8.5 3.806 0 8.5 0zm0 1.5c-3.866 0-7 3.134-7 7s3.134 7 7 7 7-3.134 7-7-3.134-7-7-7zm-.09 9.22c.613 0 .92.32.92.96 0 .64-.307.96-.92.96-.607 0-.91-.32-.91-.96 0-.64.303-.96.91-.96zm.15-5.95c.627 0 1.123.157 1.49.47.393.333.59.81.59 1.43 0 .313-.09.62-.27.92-.073.113-.163.24-.27.38l-.47.54c-.053.06-.1.12-.14.18-.107.133-.19.26-.25.38-.16.293-.223.597-.19.91H7.77c-.053-.367-.01-.717.13-1.05.053-.133.13-.273.23-.42.073-.113.167-.24.28-.38l.56-.68c.173-.247.26-.473.26-.68 0-.547-.283-.82-.85-.82-.38 0-.75.187-1.11.56l-.81-.74c.273-.313.58-.553.92-.72.367-.187.76-.28 1.18-.28z'/%3E %3C/svg%3E" alt="프립 피드란?"></button>
        </div>
        <!-- 글작성 버튼 -->
        <a th:href="@{/community/register}" style="margin-right: -8px" class="down785px">
            <div class="writeBtn" >
                <button class="PlusLink__IconBtn-sc-7f77eh-0 faWmEE">
                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='18' height='20' viewBox='0 0 18 20'%3E %3Cpath fill='%234E5968' fill-rule='evenodd' d='M9 .765c.552 0 1 .447 1 1v7.392h7c.552 0 1 .448 1 1v.098c0 .552-.448 1-1 1h-7v7.392c0 .552-.448 1-1 1s-1-.448-1-1v-7.392H1c-.552 0-1-.448-1-1v-.098c0-.552.448-1 1-1h7V1.765c0-.553.448-1 1-1z'/%3E %3C/svg%3E" alt="+">
                </button>
            </div>
        </a>
    </div>


    <!-- 필터 추가 -->
    <div class="Filter__FilterButtonWrapper-sc-1buujtg-1 gRnEmw">
        <div class="filter_wrapper_3l">
            <div class="FilterAll__Wrapper-tqa6fq-0 jJIWoq">
                <div class="FilterOpenButton__Wrapper-sc-91gci-0 NVKNq allFilter">
                    <button height="auto" color="initial" font-size="14px" font-weight="500" class="Button-bqxlp0-0 fFBpBV">
                        전체
                        <button height="18px" class="Button-bqxlp0-0 FilterOpenButton__CloseButton-sc-91gci-1 gRNDCb">
                            <img src="/imgin/community/blueClose.png" class="FilterOpenButton__CloseIcon-sc-91gci-2 hnfyOW"></button></button>
                </div>
            </div>
            <div class="FilterCook__Wrapper-sc-1w6ksuy-0 jJIWoq">
                <div class="FilterOpenButton__Wrapper-sc-91gci-0 NVKNq childFilter cookFilter">
                    <button height="auto" color="initial" font-size="14px" font-weight="500" class="Button-bqxlp0-0 fFBpBV">
                        요리
                        <button height="18px" class="Button-bqxlp0-0 FilterOpenButton__CloseButton-sc-91gci-1 gRNDCb">
                            <img src="/imgin/community/blueClose.png" class="FilterOpenButton__CloseIcon-sc-91gci-2 hnfyOW"></button>
                    </button>
                </div>
            </div>
            <div class="FilterSports__Wrapper-sc-1w6ksuy-0 jJIWoq">
                <div class="FilterOpenButton__Wrapper-sc-91gci-0 NVKNq childFilter exerciseFilter">
                    <button height="auto" color="initial" font-size="14px" font-weight="500" class="Button-bqxlp0-0 fFBpBV">
                        운동
                        <button height="18px" class="Button-bqxlp0-0 FilterOpenButton__CloseButton-sc-91gci-1 gRNDCb">
                            <img src="/imgin/community/blueClose.png" class="FilterOpenButton__CloseIcon-sc-91gci-2 hnfyOW"></button>
                    </button>
                </div>
            </div>
            <div class="FilterMovie__Wrapper-sc-1w6ksuy-0 jJIWoq">
                <div class="FilterOpenButton__Wrapper-sc-91gci-0 NVKNq childFilter movieFilter">
                    <button height="auto" color="initial" font-size="14px" font-weight="500" class="Button-bqxlp0-0 fFBpBV">
                        영화
                        <button height="18px" class="Button-bqxlp0-0 FilterOpenButton__CloseButton-sc-91gci-1 gRNDCb">
                            <img src="/imgin/community/blueClose.png" class="FilterOpenButton__CloseIcon-sc-91gci-2 hnfyOW"></button>
                    </button>
                </div>
            </div>
            <div class="FilterBook__Wrapper-sc-1w6ksuy-0 jJIWoq">
                <div class="FilterOpenButton__Wrapper-sc-91gci-0 NVKNq childFilter bookFilter">
                    <button height="auto" color="initial" font-size="14px" font-weight="500" class="Button-bqxlp0-0 fFBpBV">
                        책
                        <button height="18px" class="Button-bqxlp0-0 FilterOpenButton__CloseButton-sc-91gci-1 gRNDCb">
                            <img src="/imgin/community/blueClose.png" class="FilterOpenButton__CloseIcon-sc-91gci-2 hnfyOW"></button>
                    </button>
                </div>
            </div>
            <div class="FilterDiary__Wrapper-sc-1w6ksuy-0 jJIWoq">
                <div class="FilterOpenButton__Wrapper-sc-91gci-0 NVKNq childFilter diaryFilter">
                    <button height="auto" color="initial" font-size="14px" font-weight="500" class="Button-bqxlp0-0 fFBpBV">
                        일기
                        <button height="18px" class="Button-bqxlp0-0 FilterOpenButton__CloseButton-sc-91gci-1 gRNDCb">
                            <img src="/imgin/community/blueClose.png" class="FilterOpenButton__CloseIcon-sc-91gci-2 hnfyOW"></button>
                    </button>
                </div>
            </div>
        </div>
        <!-- 글작성 버튼 -->
        <a th:href="@{/community/register}" style="margin-right: -8px" class="until785px">
            <div class="writeBtn" >
                <button class="PlusLink__IconBtn-sc-7f77eh-0 faWmEE">
                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='18' height='20' viewBox='0 0 18 20'%3E %3Cpath fill='%234E5968' fill-rule='evenodd' d='M9 .765c.552 0 1 .447 1 1v7.392h7c.552 0 1 .448 1 1v.098c0 .552-.448 1-1 1h-7v7.392c0 .552-.448 1-1 1s-1-.448-1-1v-7.392H1c-.552 0-1-.448-1-1v-.098c0-.552.448-1 1-1h7V1.765c0-.553.448-1 1-1z'/%3E %3C/svg%3E" alt="+">
                </button>
            </div>
        </a>
    </div>



    <div class="Fade__Wrapper-sc-1s0ipfq-0 koasSX" style="opacity: 1; display: block;">
        <div class="view__FeedListWrapper-sc-1fff32g-0 ciajVR">

            <!--본문 게시글 -->
        </div>
    </div>
</div>



<!-- 페이지 설명 모달 -->
<div id="modal-page">
    <div>
        <div class="ActionSheet__Container-akkdcx-0 jgFMVr pageIntroduce_modalContainer_1h">
            <div class="ActionSheet__Content-akkdcx-2 cyEVkt pageIntroduce_Container_1h">
                <header class="ActionSheet__Header-akkdcx-3"></header><header class="Ver4__TitleVer4-d1i4tu-0 kNwzQK " style=" padding: 35px 20px 0px;
    font-size: 22px; line-height: 30px;color: rgb(51, 61, 75); font-weight: bold;">자유게시판 활용법</header>
                <div class="WhatIsActionSheet__Body-sc-10e5q0f-0 cblWvR">
                    <strong class="WhatIsActionSheet__Summary-sc-10e5q0f-1 bAnoxg">자유게시판을 통해 나를 표현하고 <span role="img" aria-label="sunglasses">😎</span><br>
                        다른 사람들과 마음껏 소통 해보세요.</strong>
                    <p class="WhatIsActionSheet__Description-sc-10e5q0f-2 dkImul">
                        자유게시판에서 즐거웠고 행복했던 순간들을 또는 슬프고 속상했던 순간들을 자유롭게 표현하며 나의 속마음을 털어보세요.<br> 그리고 다른 사람들과 나의 마음을 공유해 보세요.
                    </p>
                    <p class="WhatIsActionSheet__Comment-sc-10e5q0f-3 cMDWip">
                        나를 다른 사람들과 비교하지마세요. 충분히 잘해내고 있습니다.
                    </p>
                </div>
                <img src="https://www.frip.co.kr/365535eb402ce8672ce933afcebe47b9.png" class="WhatIsActionSheet__ImageBanner-sc-10e5q0f-4 kYigqi">
            </div>
            <div class="ActionSheet__Overlay-akkdcx-1 eCzJv">
            </div>
        </div>
    </div>
</div>
<!-- 신고 모달-->
<div id="modal-root">
    <div>
        <div class="Dialog__Container-sc-16kwpqb-0 htiyxZ">
            <div class="BodyScrollLockContainer__Container-sc-19uqzq5-0 idpZym Dialog__StyledBodyScrollLockContainer-sc-16kwpqb-1 dCXZYJ">
                <div class="Dialog__Content-sc-16kwpqb-5 ibqqJA">
                    <div class="DialogDelete__Content-p8gubf-0 jZuxbV"><p>해당 게시글을</p>
                        <p>신고 하시겠습니까?</p></div>
                </div>
                <div class="Dialog__ButtonGroup-sc-16kwpqb-6 bZEORB">
                    <button width="100%" height="auto" color="black"
                            class="Button-bqxlp0-0 Dialog__StyledButton-sc-16kwpqb-7 kXWQPc">취소
                    </button>
                    <button width="100%" height="auto" color="#ff6666" font-weight="bold"
                            class="Button-bqxlp0-0 Dialog__StyledButton-sc-16kwpqb-7 bQKwTd">신고
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!--로딩중-->
<div class="back-drop" style="display:none;">
    <img src="./svg/spinner-solid.svg"/>
</div>
</body>
<script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
<script src="/js/community/community.js"></script>
<script src="/js/fix/header.js"></script>
<script src="/js/community/communityClick.js"></script>
<script>
    const $wrapper = $(".jIjcTX");
    $wrapper.next().css("overflow-x","unset");
    // $(".writeBtn").css("right","30.4%");

    checkUser();

    function checkUser(){
        if($("input[name='userId']").val()==""){
            showWithOutUser();
        }
        else{
            show();
        }
    }

    // 화면 출력 함수 호출
    function show() {
        console.log(communityService);
        communityService.getList({
            page: page
        }, getList);
    }

    function showWithOutUser() {
        console.log(communityService);
        communityService.getListNotUser({
            page: page
        }, getList);
    }




    /*화면 출력*/
    function getList(communityPostDTO){
        let text ="";
        console.log(communityPostDTO);
        communityPostDTO.forEach(post => {

            let imageSrc = "/community/display?fileName=" + post.communityFilePath + "/" + post.communityFileUuid + "_" + post.communityFileName;
            let userImageSrc = "/community/display?fileName=" + post.userFilePath + "/" + post.userFileUuid + "_" + post.userFileName;
            // 작성자 프로필 사진, 닉네임
            text +=`<div><div class="Profile__Wrapper-sc-14xkqhl-0 ePpOcl CardFeed__StyledProfile-sc-1hnsnr8-0 kHXXhk">`;
            text +=`<div class="Profile__UserProfileWrapper-sc-14xkqhl-1 jHdfwa">`;
            text += `<div class="Profile__ProfileImageWrapper-sc-14xkqhl-2 kHBCa-D">`;
            text +=`<div class="Image__Wrapper-v97gyx-0 gDuKGF">`;

            <!--프로필 사진-->
            text +=`<div class="Fade__Wrapper-sc-1s0ipfq-0 koasSX" style="opacity: 1; display: block;">`;
            text +=`<div class="Ratio " style="display: block;">`;
            text +=`<div class="Ratio-ratio " style="height: 0px; position: relative; width: 100%; padding-top: 100%;">`;
            text+=`<div class="Ratio-content " style="height: 100%; left: 0px; position: absolute; top: 0px; width: 100%;">`;
            text +=`<img class="Image__StyledImage-v97gyx-1 hPRDQO" width="36" height="36" src="`;
            // 프로필 사진 이미지 부분
            if(post.userFileName){
                text+=userImageSrc;
            } else{
                text +=`/imgin/user.png`;
            }
            text +=`"></div></div></div></div></div></div>`;
            <!--작성자 아이디, 날짜-->
            text+=`<div class="Profile__UserTextWrapper-sc-14xkqhl-4 hopp"><p class="Profile__Name-sc-14xkqhl-3 jeiGkC">`;
            // 아이디
            text+= post.userNickName;
            text+=`</p><div class="Profile__Time-sc-14xkqhl-5 gqDWoy">`;
            //날짜
            text+= post.updatedDate;
            text+=`</div></div></div><button class="Profile__MoreButton-sc-14xkqhl-6 lbwitP" onclick="modalOpen()">`;
            <!--도시락 버튼 + 신고 버튼-->
            text+=`<img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='4' height='17' viewBox='0 0 4 17'%3E %3Cpath fill='%23999' fill-rule='evenodd' d='M1.57 14a1.5 1.5 0 110 3 1.5 1.5 0 010-3zm0-7a1.5 1.5 0 110 3 1.5 1.5 0 010-3zm0-7a1.5 1.5 0 110 3 1.5 1.5 0 010-3z'/%3E %3C/svg%3E" alt=""></button></div>`;
            text+=`<a class="goCommunity" href="`+ "/community/read?communityPostId=" + post.communityPostId +`">`;
            text+=`<div class="Ratio ImageBanner__Wrapper-dpw3a4-0 jZxoCa" style="display: block;">`;
            text+=`<div className = "Ratio-ratio " style = "height: 0px; position: relative; width: 100%; padding-top: 100%;">`;
            text+=`<div class="Ratio-content " style="height: 100%; left: 0px; position: absolute; top: 0px; width: 100%;">`
            text+=`<div class="FeedImage__Wrapper-sc-1g1oaf4-0 jGjBCL">`;
            text+=`<div class="Fade__Wrapper-sc-1s0ipfq-0 koasSX" style="opacity: 1; display: block;"><div><img src="`;
            // 썸네일 이미지
            text+=imageSrc;
            text+=`"></div></div></div></div></div></div>`;
            <!--본문 내용-->

            text+=`<div class="Description__Wrapper-ogh69p-0 lhIpIh CardFeed__StyledDescription-sc-1hnsnr8-2 eOhuaj" style="margin-top:10px;">`;
            text+=`<span class="SpanLineClamp-my36n9-0 Description__StyledSpanLineClamp-ogh69p-2 dwGwRt">`;
            // 본문 텍스트
            text+=post.communityTitle;
            text+=`</span><button class="Description__ExpandButton-ogh69p-1 djffyn"></button></div></a>`;
            // 좋아요, 댓글
            text+=`<div class="ActionGroup__Wrapper-sg91np-0 cXiDYn">`;
            text+=`<a class="ActionGroup__LikeButton-sg91np-1 jxmvcs" href="`;
            text+=post.communityPostId + `">`;
            // 좋아요 눌렀을 때 이미지
            if($("input[name='userId']").val()==""){
                text+=`<img class="checkLike likePlus" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='21' height='18' viewBox='0 0 21 18'%3E %3Cpath fill='none' stroke='%234E5968' stroke-width='1.5' d='M15.657.75c-1.226 0-2.379.485-3.246 1.365l-1.91 1.94-1.912-1.94C7.722 1.235 6.57.75 5.343.75s-2.378.485-3.245 1.365C1.198 3.028.75 4.227.75 5.425c0 1.199.448 2.398 1.348 3.31l8.425 8.504 8.379-8.504c.9-.912 1.348-2.111 1.348-3.31 0-1.198-.448-2.397-1.347-3.31-.867-.88-2.02-1.365-3.246-1.365z'/%3E %3C/svg%3E" alt="좋아요~"><span class="likeNumber">`;
            }
            else if(!post.checkLike){
                text+=`<img class="checkLike likeCancel" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='21' height='18' viewBox='0 0 21 18'%3E %3Cpath fill='%23F32D2D' d='M19.437 1.589C18.427.564 17.085 0 15.657 0s-2.77.564-3.78 1.589L10.5 2.986 9.124 1.59C8.114.564 6.77 0 5.344 0c-1.429 0-2.771.564-3.78 1.589-2.085 2.115-2.085 5.557 0 7.673l8.379 8.504c.148.15.348.234.557.234.209 0 .41-.084.557-.234l8.38-8.504c2.084-2.116 2.084-5.558 0-7.673z'/%3E %3C/svg%3E" alt="좋아요~"><span>`;
            }
            else{
                // 좋아요 안눌었을 때 이미지
                text+=`<img class="checkLike likePlus" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='21' height='18' viewBox='0 0 21 18'%3E %3Cpath fill='none' stroke='%234E5968' stroke-width='1.5' d='M15.657.75c-1.226 0-2.379.485-3.246 1.365l-1.91 1.94-1.912-1.94C7.722 1.235 6.57.75 5.343.75s-2.378.485-3.245 1.365C1.198 3.028.75 4.227.75 5.425c0 1.199.448 2.398 1.348 3.31l8.425 8.504 8.379-8.504c.9-.912 1.348-2.111 1.348-3.31 0-1.198-.448-2.397-1.347-3.31-.867-.88-2.02-1.365-3.246-1.365z'/%3E %3C/svg%3E" alt="좋아요~"><span class="likeNumber">`;
            }
            // 좋아요 개수
            text+= post.communityLikeNumber;
            text+=`</span></a>`;
            text+=`<a class="goReplyBoard" style="display: flex;margin-top: 1px;" href=`;
            text+=post.communityPostId;
            text+=`>`;
            text+=`<img class="ActionGroup__ReplyLink-sg91np-2 grCiwo" src="`;
            text+=`data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='21' height='18' viewBox='0 0 21 18'%3E %3Cpath fill='none' stroke='%234E5968' stroke-width='1.5' d='M20.25.75H.75v11.818h3.842v4.015l5.9-4.015h9.758V.75z'/%3E %3C/svg%3E`;
            text+=`" alt="댓글">`;
            text+=`<span>`;
            // 댓글
            text+=post.communityReplyCount;
            text+=`</span></img></a></div></div>`;
        })
        $(".view__FeedListWrapper-sc-1fff32g-0.ciajVR").append(text);
    }
</script>
</html>